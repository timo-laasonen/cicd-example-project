plugins {
    id "com.github.node-gradle.node" version "3.5.1"
}

node {
  // Version of node to use.
  version = '18.15.0'

  // Version of npm to use.
  npmVersion = '9.5.0'

  download = true
}

tasks.register('build')

tasks.register('package', Zip) {
    archiveFileName = "trainSchedule.zip"
}

tasks.named('package') {
    destinationDirectory = layout.buildDirectory.dir("dist")
    from '.'
    include(
        '*', 
        'bin/**', 
        'data/**', 
        'node_modules/**', 
        'public/**', 
        'routes/**', 
        'views/**'
    )
}
tasks.named('build') {
  dependsOn('package')
}
tasks.named('package') {
  dependsOn('npmInstall', 'npm_test')
}
tasks.named('npm_test') {
  dependsOn('npmInstall')
}